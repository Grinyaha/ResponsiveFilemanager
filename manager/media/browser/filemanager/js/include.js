var encodeURL,show_animation,hide_animation,apply,apply_none,apply_img,apply_any,apply_video,apply_link,apply_file_rename,apply_file_duplicate,apply_folder_rename;!function(f,r,a){"use strict";function i(e){var a;a=1==jQuery("#ftp").val()?jQuery("#ftp_base_url").val()+jQuery("#upload_dir").val()+jQuery("#fldr_value").val():jQuery("#base_url").val()+jQuery("#cur_dir").val();var t=e.find("a.link").attr("data-file");return""!=t&&null!=t&&(a+=t),""!=(t=e.find("h4 a.folder-link").attr("data-file"))&&null!=t&&(a+=t),a}var t,n=null,u=0,o=(t=0,function(e,a){clearTimeout(t),t=setTimeout(e,a)}),c={contextActions:{copy_url:function(e){e=i(e);bootbox.alert('URL:<br/><div class="input-append" style="width:100%"><input id="url_text" type="text" style="width:80%; height:30px;" value="'+encodeURL(e)+'" /><button id="copy-button" class="btn btn-inverse copy-button" style="width:20%; height:30px;" data-clipboard-target="#url_text" title="copy"><i class="icon icon-white icon-share"></i> '+jQuery("#lang_copy").val()+"</button></div>")},unzip:function(e){e=jQuery("#sub_folder").val()+jQuery("#fldr_value").val()+e.find("a.link").attr("data-file");show_animation(),f.ajax({type:"POST",url:"ajax_calls.php?action=extract",data:{path:e}}).done(function(e){hide_animation(),""!=e?bootbox.alert(e):window.location.href=jQuery("#refresh").attr("href")+"&"+(new Date).getTime()})},edit_img:function(e){var a=e.attr("data-name"),t=e.attr("data-path");e=1==jQuery("#ftp").val()?jQuery("#ftp_base_url").val()+jQuery("#upload_dir").val()+jQuery("#fldr_value").val()+a:jQuery("#base_url").val()+jQuery("#upload_dir").val()+t;t=jQuery("#tui-image-editor");t.attr("data-name",a),t.attr("data-path",e),show_animation(),t.attr("id"),e=e,imageEditor.loadImageFromURL(e,"SampleImage").then(e=>{imageEditor.ui.resizeEditor({imageSize:{oldWidth:e.oldWidth,oldHeight:e.oldHeight,newWidth:e.newWidth,newHeight:e.newHeight}})}).catch(e=>{bootbox.alert("Something went wrong: "+e)}),hide_animation(),t.removeClass("hide")},duplicate:function(a){var t=a.find("h4").text().trim();bootbox.prompt(jQuery("#lang_duplicate").val(),jQuery("#cancel").val(),jQuery("#ok").val(),function(e){null!==e&&(e=Q(e))!=t&&g("duplicate_file",a.attr("data-path"),e,a,"apply_file_duplicate")},t+" - copy")},select:function(e){var a=i(e),t=jQuery("#field_id").val();1==jQuery("#return_relative_url").val()&&(a=(a=a.replace(jQuery("#base_url").val(),"")).replace(jQuery("#cur_dir").val(),"")),e=1==jQuery("#popup").val()?window.opener:window.parent,""!=t?1==jQuery("#crossdomain").val()?e.postMessage({sender:"responsivefilemanager",url:a,field_id:t},"*"):(e.jQuery("#"+t).val(a).trigger("change"),"function"==typeof e.responsive_filemanager_callback&&e.responsive_filemanager_callback(t),j()):apply_any(a)},copy:function(e){s(e,"copy")},cut:function(e){s(e,"cut")},paste:function(){d()},chmod:function(e){!function(e){jQuery("#files_permission_start").parent().parent().remove();var r=e.find(".rename-file-paths"),i=e.closest("figure").attr("data-path"),e=r.attr("data-permissions"),n=r.attr("data-folder");f.ajax({type:"POST",url:"ajax_calls.php?action=chmod",data:{path:i,permissions:e,folder:n}}).done(function(e){bootbox.dialog(e,[{label:jQuery("#cancel").val(),class:"btn"},{label:jQuery("#ok").val(),class:"btn-inverse",callback:function(){var a="-";jQuery("#u_4").is(":checked")?a+="r":a+="-",jQuery("#u_2").is(":checked")?a+="w":a+="-",jQuery("#u_1").is(":checked")?a+="x":a+="-",jQuery("#g_4").is(":checked")?a+="r":a+="-",jQuery("#g_2").is(":checked")?a+="w":a+="-",jQuery("#g_1").is(":checked")?a+="x":a+="-",jQuery("#a_4").is(":checked")?a+="r":a+="-",jQuery("#a_2").is(":checked")?a+="w":a+="-",jQuery("#a_1").is(":checked")?a+="x":a+="-";var e,t=jQuery("#chmod_form #chmod_value").val();""!=t&&void 0!==t&&(""!=(e=jQuery("#chmod_form input[name=apply_recursive]:checked").val())&&void 0!==e||(e="none"),f.ajax({type:"POST",url:"execute.php?action=chmod",data:{path:i,new_mode:t,is_recursive:e,folder:n}}).done(function(e){""!=e?bootbox.alert(e):r.attr("data-permissions",a)}))}}],{header:jQuery("#lang_file_permission").val()}),setTimeout(function(){l(!1)},100)})}(e)},edit_text_file:function(e){!function(a){jQuery("#textfile_edit_area").parent().parent().remove();var t=a.closest("figure").attr("data-path");f.ajax({type:"POST",url:"ajax_calls.php?action=get_file&sub_action=edit&preview_mode=text",data:{path:t}}).done(function(e){bootbox.dialog(e,[{label:jQuery("#cancel").val(),class:"btn"},{label:jQuery("#ok").val(),class:"btn-inverse",callback:function(){var e=jQuery("#textfile_edit_area").val();window.editor&&"function"==typeof window.editor.getData&&(e=window.editor.getData()),f.ajax({type:"POST",url:"execute.php?action=save_text_file",data:{path:t,new_content:e}}).done(function(e){""!=e&&bootbox.alert(e)})}}],{header:a.find(".name_download").val()})})}(e)}},makeContextMenu:function(){var r=this;f.contextMenu({selector:"figure:not(.back-directory), .list-view2 figure:not(.back-directory)",autoHide:!0,build:function(t){t.addClass("selected");var e={callback:function(e,a){r.contextActions[e](t)},items:{}};return(t.find(".img-precontainer-mini .filetype").hasClass("png")||t.find(".img-precontainer-mini .filetype").hasClass("jpg")||t.find(".img-precontainer-mini .filetype").hasClass("jpeg"))&&a&&(e.items.edit_img={name:jQuery("#lang_edit_image").val(),icon:"edit_img",disabled:!1}),t.hasClass("directory")&&0!=jQuery("#type_param").val()&&(e.items.select={name:jQuery("#lang_select").val(),icon:"",disabled:!1}),e.items.copy_url={name:jQuery("#lang_show_url").val(),icon:"url",disabled:!1},(t.find(".img-precontainer-mini .filetype").hasClass("zip")||t.find(".img-precontainer-mini .filetype").hasClass("tar")||t.find(".img-precontainer-mini .filetype").hasClass("gz"))&&1==jQuery("#extract_files").val()&&(e.items.unzip={name:jQuery("#lang_extract").val(),icon:"extract",disabled:!1}),t.find(".img-precontainer-mini .filetype").hasClass("edit-text-file-allowed")&&(e.items.edit_text_file={name:jQuery("#lang_edit_file").val(),icon:"edit",disabled:!1}),t.hasClass("directory")||1!=jQuery("#duplicate").val()||(e.items.duplicate={name:jQuery("#lang_duplicate").val(),icon:"duplicate",disabled:!1}),(!t.hasClass("directory")&&1==jQuery("#copy_cut_files_allowed").val()||t.hasClass("directory")&&1==jQuery("#copy_cut_dirs_allowed").val())&&(e.items.copy={name:jQuery("#lang_copy").val(),icon:"copy",disabled:!1},e.items.cut={name:jQuery("#lang_cut").val(),icon:"cut",disabled:!1}),0==jQuery("#clipboard").val()||t.hasClass("directory")||(e.items.paste={name:jQuery("#lang_paste_here").val(),icon:"clipboard-apply",disabled:!1}),(!t.hasClass("directory")&&1==jQuery("#chmod_files_allowed").val()||t.hasClass("directory")&&1==jQuery("#chmod_dirs_allowed").val())&&(e.items.chmod={name:jQuery("#lang_file_permission").val(),icon:"key",disabled:!1}),e.items.sep="----",e.items.info={type:"html",html:"<strong>"+jQuery("#lang_file_info").val()+"</strong>"},e.items.name={name:t.attr("data-name"),icon:"label",disabled:!0},"img"==t.attr("data-type")&&(e.items.dimension={name:t.find(".img-dimension").html(),icon:"dimension",disabled:!0}),"true"!==jQuery("#show_folder_size").val()&&"true"!==jQuery("#show_folder_size").val()||(t.hasClass("directory")?e.items.size={name:t.find(".file-size").html()+" - "+t.find(".nfiles").val()+" "+jQuery("#lang_files").val()+" - "+t.find(".nfolders").val()+" "+jQuery("#lang_folders").val(),icon:"size",disabled:!0}:e.items.size={name:t.find(".file-size").html(),icon:"size",disabled:!0}),e.items.date={name:t.find(".file-date").html(),icon:"date",disabled:!0},e},events:{hide:function(){jQuery("figure").removeClass("selected")}}}),jQuery(document).on("contextmenu",function(e){if(!jQuery(e.target).is("figure"))return!1})},updateMultipleSelectionButtons:function(){0<u?jQuery("#multiple-selection").show(300):jQuery("#multiple-selection").hide(300)},bindGridEvents:function(){var e=jQuery("ul.grid");function t(e){var a=e.attr("data-function");"apply_multiple"==a?(e.find(".selection:visible").trigger("click"),e.find(".selector:visible").trigger("click")):window[a](e.attr("data-file"),jQuery("#field_id").val(),e)}e.on("click",".modalAV",function(e){var a=jQuery(this);e.preventDefault();var e=jQuery("#previewAV"),t=jQuery(".body-preview");e.removeData("modal"),e.modal({backdrop:"static",keyboard:!1}),a.hasClass("audio")?t.css("height","80px"):t.css("height","345px"),f.ajax({url:a.attr("data-url"),success:function(e){t.html(e)}})}),e.on("click",".file-preview-btn",function(e){var a=jQuery(this);e.preventDefault(),f.ajax({url:a.attr("data-url"),success:function(e){bootbox.modal(e," "+a.parent().parent().parent().find(".name").val())}})}),e.on("click",".preview",function(){var e=jQuery(this);return 0==e.hasClass("disabled")&&jQuery("#full-img").attr("src",decodeURIComponent(e.attr("data-url"))),!0}),e.on("click",".rename-file",function(){var a=jQuery(this).closest("figure"),t=a.attr("data-path"),e=a.find("h4"),r=f.trim(e.text());bootbox.prompt(jQuery("#rename").val(),jQuery("#cancel").val(),jQuery("#ok").val(),function(e){null!==e&&(e=Q(e))!=r&&g("rename_file",t,e,a,"apply_file_rename")},r)}),e.on("click",".rename-folder",function(){var a=jQuery(this).closest("figure"),t=a.attr("data-path"),e=a.find("h4"),r=f.trim(e.text());bootbox.prompt(jQuery("#rename").val(),jQuery("#cancel").val(),jQuery("#ok").val(),function(e){null!==e&&(e=Q(e).replace(".",""))!=r&&g("rename_folder",t,e,a,"apply_folder_rename")},r)}),e.on("click",".delete-file",function(){var a=jQuery(this),t=a.closest("figure").attr("data-path");bootbox.confirm(a.attr("data-confirm"),jQuery("#cancel").val(),jQuery("#ok").val(),function(e){1==e&&(g("delete_file",t,"","",""),(e=jQuery("#files_number")).text(parseInt(e.text())-1),a.parent().parent().parent().parent().remove())})}),e.on("click",".delete-folder",function(){var a=jQuery(this),t=a.closest("figure").attr("data-path");bootbox.confirm(a.attr("data-confirm"),jQuery("#cancel").val(),jQuery("#ok").val(),function(e){1==e&&(g("delete_folder",t,"","",""),(e=jQuery("#folders_number")).text(parseInt(e.text())-1),a.parent().parent().parent().remove())})}),jQuery("ul.grid").on("click",".link",function(e){e.stopPropagation(),t(jQuery(this))}),jQuery("ul.grid").on("click","div.box",function(e){var a=jQuery(this).find(".link");0!==a.length?t(a):0!==(a=jQuery(this).find(".folder-link")).length&&(document.location=jQuery(a).prop("href"))})},makeFilters:function(e){jQuery("#filter-input").on("keyup",function(){u=0,f(".selection:checkbox").removeAttr("checked"),c.updateMultipleSelectionButtons(),jQuery(".filters label").removeClass("btn-inverse"),jQuery(".filters label").find("i").removeClass("icon-white"),jQuery("#ff-item-type-all").addClass("btn-inverse"),jQuery("#ff-item-type-all").find("i").addClass("icon-white");var a=Q(jQuery(this).val()).toLowerCase();jQuery(this).val(a),e&&o(function(){jQuery("li","ul.grid ").each(function(){var e=jQuery(this);""!=a&&-1==e.attr("data-name").toLowerCase().indexOf(a)?e.hide(100):e.show(100)}),f.ajax({url:"ajax_calls.php?action=filter&type="+a}).done(function(e){""!=e&&bootbox.alert(e)}),o(function(){_(0!=jQuery("#descending").val(),"."+jQuery("#sort_by").val()),b()},500)},300)}).keypress(function(e){13==e.which&&jQuery("#filter").trigger("click")}),jQuery("#filter").on("click",function(){var e=Q(jQuery("#filter-input").val()),a=jQuery("#current_url").val();0<=a.indexOf("?")?a+="&":a+="?",window.location.href=a+"filter="+e})},makeUploader:function(){jQuery("#fileupload").fileupload({url:"upload.php",maxChunkSize:2097152}),jQuery("#fileupload").bind("fileuploaddrop",function(e,a){jQuery(".uploader").show(200),setTimeout(function(){jQuery("#fileupload > div > div.fileupload-buttonbar > div.text-center > button").click()},200)}),jQuery("#fileupload").bind("fileuploadsubmit",function(e,a){a.formData={fldr:jQuery("#sub_folder").val()+jQuery("#fldr_value").val()+(a.files[0].relativePath||a.files[0].webkitRelativePath||"")}}),jQuery("#fileupload").addClass("fileupload-processing"),f.ajax({url:jQuery("#fileupload").fileupload("option","url"),dataType:"json",context:jQuery("#fileupload")[0]}).always(function(){jQuery(this).removeClass("fileupload-processing")}),jQuery(".upload-btn").on("click",function(){jQuery(".uploader").show(200)}),jQuery(".close-uploader").on("click",function(){jQuery(".uploader").hide(200),setTimeout(function(){window.location.href=jQuery("#refresh").attr("href")+"&"+(new Date).getTime()},420)})},uploadURL:function(){jQuery("#uploadURL").on("click",function(e){e.preventDefault();var a=jQuery("#url").val(),e=jQuery("#fldr_value").val();show_animation(),f.ajax({type:"POST",url:"upload.php",data:{fldr:e,url:a}}).done(function(e){hide_animation(),jQuery("#url").val("")}).fail(function(e){bootbox.alert(jQuery("#lang_error_upload").val()),hide_animation(),jQuery("#url").val("")})})},makeSort:function(r){jQuery("input[name=radio-sort]").on("click",function(){var e=jQuery(this).attr("data-item"),a=jQuery("#"+e),t=jQuery(".filters label");u=0,f(".selection:checkbox").removeAttr("checked"),c.updateMultipleSelectionButtons(),t.removeClass("btn-inverse"),t.find("i").removeClass("icon-white"),jQuery("#filter-input").val(""),a.addClass("btn-inverse"),a.find("i").addClass("icon-white"),"ff-item-type-all"==e?(r?jQuery(".grid li").show(300):window.location.href=jQuery("#current_url").val()+"&sort_by="+jQuery("#sort_by").val()+"&descending="+(i?1:0),"undefined"!=typeof Storage&&localStorage.setItem("sort","")):jQuery(this).is(":checked")&&(jQuery(".grid li").not("."+e).hide(300),jQuery(".grid li."+e).show(300),"undefined"!=typeof Storage&&localStorage.setItem("sort",e)),b()});var i=jQuery("#descending").val();jQuery(".sorter").on("click",function(){var e=jQuery(this);i=jQuery("#sort_by").val()!==e.attr("data-sort")||0==i,r?(f.ajax({url:"ajax_calls.php?action=sort&sort_by="+e.attr("data-sort")+"&descending="+(i?1:0)}),_(i,"."+e.attr("data-sort")),jQuery(" a.sorter").removeClass("descending").removeClass("ascending"),i?jQuery(".sort-"+e.attr("data-sort")).addClass("descending"):jQuery(".sort-"+e.attr("data-sort")).addClass("ascending"),jQuery("#sort_by").val(e.attr("data-sort")),jQuery("#descending").val(i?1:0),b()):window.location.href=jQuery("#current_url").val()+"&sort_by="+e.attr("data-sort")+"&descending="+(i?1:0)})}};function l(e){var r=[];r.user=0,r.group=0,void(r.all=0)!==e&&1==e?(e=jQuery("#chmod_form #chmod_value").val(),r.user=e.substr(0,1),r.group=e.substr(1,1),r.all=e.substr(2,1),f.each(r,function(e){(""==r[e]||0==f.isNumeric(r[e])||parseInt(r[e])<0||7<parseInt(r[e]))&&(r[e]="0")}),jQuery("#chmod_form input:checkbox").each(function(){var e,a=jQuery(this).attr("data-group"),t=jQuery(this).attr("data-value");e=r[a],a=t,(t=[])[1]=[1,3,5,7],t[2]=[2,3,6,7],t[4]=[4,5,6,7],e=parseInt(e),a=parseInt(a),-1!=f.inArray(e,t[a])?jQuery(this).prop("checked",!0):jQuery(this).prop("checked",!1)})):(jQuery("#chmod_form input:checkbox:checked").each(function(){var e=jQuery(this).attr("data-group"),a=jQuery(this).attr("data-value");r[e]=parseInt(r[e])+parseInt(a)}),jQuery("#chmod_form #chmod_value").val(r.user.toString()+r.group.toString()+r.all.toString()))}function s(e,a){"copy"!=a&&"cut"!=a||(e=e.closest("figure").attr("data-path"),f.ajax({type:"POST",url:"ajax_calls.php?action=copy_cut",data:{path:e,sub_action:a}}).done(function(e){""!=e?bootbox.alert(e):(jQuery("#clipboard").val("1"),p(!0))}))}function d(a){bootbox.confirm(jQuery("#lang_paste_confirm").val(),jQuery("#cancel").val(),jQuery("#ok").val(),function(e){1==e&&(e=void 0!==a?a.closest("figure").attr("data-path"):jQuery("#sub_folder").val()+jQuery("#fldr_value").val(),f.ajax({type:"POST",url:"execute.php?action=paste_clipboard",data:{path:e}}).done(function(e){""!=e?bootbox.alert(e):(jQuery("#clipboard").val("0"),p(!1),setTimeout(function(){window.location.href=jQuery("#refresh").attr("href")+"&"+(new Date).getTime()},300))}))})}function p(e){1==e?jQuery(".paste-here-btn, .clear-clipboard-btn").removeClass("disabled"):jQuery(".paste-here-btn, .clear-clipboard-btn").addClass("disabled")}function y(e){var a=jQuery(".breadcrumb").width()+e,t=jQuery("#view"),e=jQuery("#help");0<t.val()?(1==t.val()?jQuery("ul.grid li, ul.grid figure").css("width","100%"):(0==(t=Math.floor(a/380))&&(t=1,jQuery("h4").css("font-size",12)),a=Math.floor(a/t-3),jQuery("ul.grid li, ul.grid figure").css("width",a)),e.hide()):r.touch&&e.show()}function v(){var e=jQuery(this);0==jQuery("#view").val()&&(1==e.attr("toggle")?(e.attr("toggle",0),e.animate({top:"0px"},{queue:!1,duration:300})):(e.attr("toggle",1),e.animate({top:"-30px"},{queue:!1,duration:300})))}function m(e){for(var a=(a=jQuery("#cur_dir").val()).replace("\\","/"),t=(jQuery("#sub_folder").val().replace("\\","/"),jQuery("#base_url").val()),r=(r=jQuery("#fldr_value").val()).replace("\\","/"),i=[],n=jQuery("#return_relative_url").val(),o=1==jQuery("#ftp").val(),l=0;l<e.length;l++){var u=e[l];o?i.push(encodeURL(jQuery("#ftp_base_url").val()+jQuery("#upload_dir").val()+r+u)):i.push(encodeURL((1==n?a:t+a)+u))}return i}function h(){return 1==jQuery("#popup").val()?window.opener:window.parent}function j(){1==jQuery("#popup").val()?window.close():("function"==typeof parent.jQuery(".modal:has(iframe)").modal&&parent.jQuery(".modal:has(iframe)").modal("hide"),void 0!==parent.jQuery&&parent.jQuery?"object"==typeof parent.jQuery.fancybox?parent.jQuery.fancybox.getInstance().close():"function"==typeof parent.jQuery.fancybox&&parent.jQuery.fancybox.close():"function"==typeof parent.$.fancybox&&parent.$.fancybox.close())}function Q(e){return null!=e?("true"==jQuery("#transliteration").val()&&(e=(e=function(e){for(var a=[/[\300-\306]/g,/[\340-\346]/g,/[\310-\313]/g,/[\350-\353]/g,/[\314-\317]/g,/[\354-\357]/g,/[\322-\330]/g,/[\362-\370]/g,/[\331-\334]/g,/[\371-\374]/g,/[\321]/g,/[\361]/g,/[\307]/g,/[\347]/g],t=["A","a","E","e","I","i","O","o","U","u","N","n","C","c"],r=0;r<a.length;r++)e=e.replace(a[r],t[r]);return e}(e)).replace(/[^A-Za-z0-9\.\-\[\] _]+/g,"")),"true"==jQuery("#convert_spaces").val()&&(e=e.replace(/ /g,jQuery("#replace_with").val())),"true"==jQuery("#lower_case").val()&&(e=e.toLowerCase()),e=(e=(e=(e=(e=e.replace('"',"")).replace("'","")).replace("/","")).replace("\\","")).replace(/<\/?[^>]+(>|$)/g,""),f.trim(e)):null}function g(e,a,t,r,i){null!==t&&(t=Q(t),f.ajax({type:"POST",url:"execute.php?action="+e,data:{path:a,name:t.replace("/","")}}).done(function(e){return""!=e?(bootbox.alert(e),!1):(""!=i&&window[i](r,t),!0)}))}function _(e,t){var a=jQuery("li.dir","ul.grid").filter(":visible"),r=jQuery("li.file","ul.grid").filter(":visible");u=0,f(".selection:checkbox").removeAttr("checked"),c.updateMultipleSelectionButtons();var i=[],n=[],o=[],l=[];a.each(function(){var e=jQuery(this),a=e.find(t).val();if(f.isNumeric(a))for(a=parseFloat(a);void 0!==i[a]&&i[a];)a=parseFloat(parseFloat(a)+parseFloat(.001));else a=a+"a"+e.find("h4 a").attr("data-file");i[a]=e.html(),n.push(a)}),r.each(function(){var e=jQuery(this),a=e.find(t).val();if(f.isNumeric(a))for(a=parseFloat(a);void 0!==o[a]&&o[a];)a=parseFloat(parseFloat(a)+parseFloat(.001));else a=a+"a"+e.find("h4 a").attr("data-file");o[a]=e.html(),l.push(a)}),f.isNumeric(n[0])?n.sort(function(e,a){return parseFloat(e)-parseFloat(a)}):n.sort(),f.isNumeric(l[0])?l.sort(function(e,a){return parseFloat(e)-parseFloat(a)}):l.sort(),e&&(n.reverse(),l.reverse()),a.each(function(e){jQuery(this).html(i[n[e]])}),r.each(function(e){jQuery(this).html(o[l[e]]),jQuery(this).attr("data-name",jQuery(this).children().attr("data-name"))})}function b(){n.update()}jQuery(document).ready(function(){var e;c.makeContextMenu(),"undefined"==typeof Storage||1==jQuery("#type_param").val()||3==jQuery("#type_param").val()||(a=localStorage.getItem("sort"))&&((e=jQuery("#"+a)).addClass("btn-inverse"),e.find("i").addClass("icon-white"),jQuery(".grid li").not("."+a).hide(300),jQuery(".grid li."+a).show(300)),jQuery(".ff-container").on("click",".checkmark",function(e){e.stopPropagation(),jQuery(this).parent().find("input").is(":checked")?u--:u++,c.updateMultipleSelectionButtons()}),jQuery("#full-img").on("click",function(){jQuery("#previewLightbox").lightbox("hide")}),jQuery("body").on("click",function(){jQuery(".tip-right").tooltip("hide")}),c.bindGridEvents(),a=!(parseInt(jQuery("#file_number").val())>parseInt(jQuery("#file_number_limit_js").val())),c.makeSort(a),c.makeFilters(a),c.uploadURL(),jQuery("#info").on("click",function(){bootbox.alert('<div class="text-center"><br/><img src="img/logo.png" alt="responsive filemanager"/><br/><br/><p><strong>RESPONSIVE filemanager v.9.14.0</strong><br/><a href="http://www.responsivefilemanager.com">responsivefilemanager.com</a></p><br/><p>Copyright © <a href="http://www.tecrail.com" alt="tecrail">Tecrail</a> - Alberto Peripolli. All rights reserved.</p><br/><p>License<br/><small><img alt="Creative Commons License" style="border-width:0" src="https://www.responsivefilemanager.com/license.php" /><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.</small></p></div>')}),jQuery("#change_lang_btn").on("click",function(){f.ajax({type:"POST",url:"ajax_calls.php?action=get_lang",data:{}}).done(function(e){bootbox.dialog(e,[{label:jQuery("#cancel").val(),class:"btn"},{label:jQuery("#ok").val(),class:"btn-inverse",callback:function(){var a=jQuery("#new_lang_select").val();f.ajax({type:"POST",url:"ajax_calls.php?action=change_lang",data:{choosen_lang:a}}).done(function(e){""!=e?bootbox.alert(e):setTimeout(function(){window.location.href=jQuery("#refresh").attr("href").replace(/lang=[\w]*&/i,"lang="+a+"&")+"&"+(new Date).getTime()},100)})}}],{header:jQuery("#lang_lang_change").val()})})}),c.makeUploader(),jQuery("body").on("keypress",function(e){e=String.fromCharCode(e.which);if("'"==e||'"'==e||"\\"==e||"/"==e)return!1}),jQuery("ul.grid li figcaption").on("click",'a[data-toggle="lightbox"]',function(){!function(e){show_animation();var a=new Image;a.src=e,jQuery(a).on("load",function(){hide_animation()})}(decodeURIComponent(jQuery(this).attr("data-url")))}),jQuery(".create-file-btn").on("click",function(){jQuery("#textfile_create_area").parent().parent().remove(),f.ajax({type:"GET",url:"ajax_calls.php?action=new_file_form"}).done(function(e){bootbox.dialog(e,[{label:jQuery("#cancel").val(),class:"btn"},{label:jQuery("#ok").val(),class:"btn-inverse",callback:function(){var e,a=jQuery("#create_text_file_name").val()+jQuery("#create_text_file_extension").val(),t=jQuery("#textfile_create_area").val();null!==a&&(a=Q(a),e=jQuery("#sub_folder").val()+jQuery("#fldr_value").val(),f.ajax({type:"POST",url:"execute.php?action=create_file",data:{path:e,name:a,new_content:t}}).done(function(e){""!=e&&bootbox.alert(e,function(){setTimeout(function(){window.location.href=jQuery("#refresh").attr("href")+"&"+(new Date).getTime()},500)})}))}}],{header:jQuery("#lang_new_file").val()})})}),jQuery(".new-folder").on("click",function(){bootbox.prompt(jQuery("#insert_folder_name").val(),jQuery("#cancel").val(),jQuery("#ok").val(),function(e){var a;null!==e&&(e=Q(e).replace(".",""),a=jQuery("#sub_folder").val()+jQuery("#fldr_value").val(),f.ajax({type:"POST",url:"execute.php?action=create_folder",data:{path:a,name:e}}).done(function(e){e?bootbox.alert(jQuery("#rename_existing_folder").val()):setTimeout(function(){window.location.href=jQuery("#refresh").attr("href")+"&"+(new Date).getTime()},300)}))})}),jQuery(".view-controller button").on("click",function(){var e=jQuery(this);jQuery(".view-controller button").removeClass("btn-inverse"),jQuery(".view-controller i").removeClass("icon-white"),e.addClass("btn-inverse"),e.find("i").addClass("icon-white"),f.ajax({url:"ajax_calls.php?action=view&type="+e.attr("data-value")}).done(function(e){""!=e&&bootbox.alert(e)}),void 0!==jQuery("ul.grid")[0]&&jQuery("ul.grid")[0]&&(jQuery("ul.grid")[0].className=jQuery("ul.grid")[0].className.replace(/\blist-view.*?\b/g,"")),void 0!==jQuery(".sorter-container")[0]&&jQuery(".sorter-container")[0]&&(jQuery(".sorter-container")[0].className=jQuery(".sorter-container")[0].className.replace(/\blist-view.*?\b/g,""));var a=e.attr("data-value");jQuery("#view").val(a),jQuery("ul.grid").addClass("list-view"+a),jQuery(".sorter-container").addClass("list-view"+a),1<=e.attr("data-value")?y(14):(jQuery("ul.grid li").css("width",126),jQuery("ul.grid figure").css("width",122)),b()}),r.touch?(jQuery("#help").show(),jQuery(".box:not(.no-effect)").swipe({swipeLeft:v,swipeRight:v,threshold:30})):(jQuery(".tip").tooltip({placement:"bottom"}),jQuery(".tip-top").tooltip({placement:"top"}),jQuery(".tip-left").tooltip({placement:"left"}),jQuery(".tip-right").tooltip({placement:"right"}),jQuery("body").addClass("no-touch")),jQuery(".paste-here-btn").on("click",function(){0==jQuery(this).hasClass("disabled")&&d()}),jQuery(".clear-clipboard-btn").on("click",function(){0==jQuery(this).hasClass("disabled")&&bootbox.confirm(jQuery("#lang_clear_clipboard_confirm").val(),jQuery("#cancel").val(),jQuery("#ok").val(),function(e){1==e&&f.ajax({type:"POST",url:"ajax_calls.php?action=clear_clipboard",data:{}}).done(function(e){""!=e?bootbox.alert(e):jQuery("#clipboard").val("0"),p(!1)})})});function o(a){var t=[];return jQuery(".selection:checkbox:checked:visible").each(function(){var e=jQuery(this).val();a&&(e=jQuery(this).closest("figure").attr("data-path")),t.push(e)}),t}var a;jQuery(".multiple-action-btn").on("click",function(){var e=o();window[jQuery(this).attr("data-function")](e,jQuery("#field_id").val())}),jQuery(".multiple-deselect-btn").on("click",function(){f(".selection:checkbox").removeAttr("checked"),jQuery("#multiple-selection").hide(300)}),jQuery(".multiple-select-btn").on("click",function(){f(".selection:checkbox:visible").prop("checked",!0)}),jQuery(".multiple-delete-btn").on("click",function(){var e;0!=jQuery(".selection:checkbox:checked:visible").length&&(e=jQuery(this),bootbox.confirm(e.attr("data-confirm"),jQuery("#cancel").val(),jQuery("#ok").val(),function(e){var a,t,r,i,n;1==e&&(a=o(!0),t="delete_files",r=a,n=i=e="",null!==name&&(name=Q(name),f.ajax({type:"POST",url:"execute.php?action="+t,data:{path:r[0],paths:r,names:e}}).done(function(e){return""!=e?(bootbox.alert(e),!1):(""!=n&&window[n](i,name),!0)})),(e=jQuery("#files_number")).text(parseInt(e.text())-a.length),jQuery(".selection:checkbox:checked:visible").each(function(){jQuery(this).closest("li").remove()}),jQuery("#multiple-selection").hide(300))}))}),r.csstransforms||((a=jQuery("figure")).on("mouseover",function(){0==jQuery("#view").val()&&!1===jQuery("#main-item-container").hasClass("no-effect-slide")&&jQuery(this).find(".box:not(.no-effect)").animate({top:"-26px"},{queue:!1,duration:300})}),a.on("mouseout",function(){0==jQuery("#view").val()&&jQuery(this).find(".box:not(.no-effect)").animate({top:"0px"},{queue:!1,duration:300})})),jQuery(window).resize(function(){y(28)}),y(14),1==jQuery("#clipboard").val()?p(!0):p(!1),jQuery("li.dir, li.file").draggable({distance:20,cursor:"move",helper:function(){jQuery(this).find("figure").find(".box").css("top","0px");var e=jQuery(this).clone().css("z-index",1e3).find(".box").css("box-shadow","none").css("-webkit-box-shadow","none").parent().parent();return jQuery(this).addClass("selected"),e},start:function(e,a){jQuery(a.helper).addClass("ui-draggable-helper"),0==jQuery("#view").val()&&jQuery("#main-item-container").addClass("no-effect-slide")},stop:function(){jQuery(this).removeClass("selected"),0==jQuery("#view").val()&&jQuery("#main-item-container").removeClass("no-effect-slide")}}),jQuery("li.dir,li.back").droppable({accept:"ul.grid li",activeClass:"ui-state-highlight",hoverClass:"ui-state-hover",drop:function(e,a){!function(a,t){a.hasClass("directory")?a.find(".rename-folder"):a.find(".rename-file");var e=a.closest("figure").attr("data-path");a.parent().hide(100),f.ajax({type:"POST",url:"ajax_calls.php?action=copy_cut",data:{path:e,sub_action:"cut"}}).done(function(e){""!=e?bootbox.alert(e):(e=void 0!==t?t.hasClass("back-directory")?t.find(".path").val():t.closest("figure").attr("data-path"):jQuery("#sub_folder").val()+jQuery("#fldr_value").val(),f.ajax({type:"POST",url:"execute.php?action=paste_clipboard",data:{path:e}}).done(function(e){""!=e?(bootbox.alert(e),a.parent().show(100)):(jQuery("#clipboard").val("0"),p(!1),a.parent().remove())}))}).error(function(){a.parent().show(100)})}(a.draggable.find("figure"),jQuery(this).find("figure"))}}),jQuery(document).on("keyup","#chmod_form #chmod_value",function(){l(!0)}),jQuery(document).on("change","#chmod_form input",function(){l(!1)}),jQuery(document).on("focusout","#chmod_form #chmod_value",function(){var e=jQuery("#chmod_form #chmod_value");null==e.val().match(/^[0-7]{3}$/)&&(e.val(e.attr("data-def-value")),l(!0))}),n=new LazyLoad,new Clipboard(".btn")}),encodeURL=function(e){for(var a=e.split("/"),t=3;t<a.length;t++);return a.join("/")},apply=function(e,a){var t=h(),r=jQuery("#callback").val(),i="",n=["ogg","mp3","wav"],o=["mp4","ogg","webm"];Array.isArray(e)||(e=new Array(e));var l=m(e),u=JSON.stringify(l);if(1==l.length&&(u=l[0]),""!=a)1==jQuery("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:u,field_id:a},"*"):(t.jQuery("#"+a).val(u).trigger("change"),0==r?"function"==typeof t.responsive_filemanager_callback&&t.responsive_filemanager_callback(a):"function"==typeof t[r]&&t[r](a),j());else{for(var c=0;c<l.length;c++){var s=e[c],d=s.substr(0,s.lastIndexOf(".")),p=(p=s.split(".").pop()).toLowerCase(),s=l[c];-1<f.inArray(p,ext_img)?(jQuery("#add_time_to_img").val()&&(s=s+"?"+(new Date).getTime()),i+='<img src="'+s+'" alt="'+d+'" /> '):-1<f.inArray(p,o)?i+='<video controls source src="'+s+'" type="video/'+p+'">'+d+"</video> ":-1<f.inArray(p,n)?("mp3"==p&&(p="mpeg"),i+='<audio controls src="'+s+'" type="audio/'+p+'">'+d+"</audio> "):i+='<a href="'+s+'" title="'+d+'">'+d+"</a> "}1==jQuery("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:u,field_id:null,html:i},"*"):parent.tinymce.majorVersion<4?(parent.tinymce.activeEditor.execCommand("mceInsertContent",!1,i),parent.tinymce.activeEditor.windowManager.close(parent.tinymce.activeEditor.windowManager.params.mce_window_id)):(parent.tinymce.activeEditor.insertContent(i),parent.tinymce.activeEditor.windowManager.close())}},apply_link=function(e,a){var t=h(),r=jQuery("#callback").val();Array.isArray(e)||(e=new Array(e));var i=m(e),e=JSON.stringify(i);1==i.length&&(e=i[0]),""!=a?1==jQuery("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:i[0],field_id:a},"*"):(t.jQuery("#"+a).val(e).trigger("change"),0==r?"function"==typeof t.responsive_filemanager_callback&&t.responsive_filemanager_callback(a):"function"==typeof t[r]&&t[r](a),j()):apply_any(i[0])},apply_img=function(e,a){var t=h(),r=jQuery("#callback").val();Array.isArray(e)||(e=new Array(e));var i=m(e),e=JSON.stringify(i);1==i.length&&(e=i[0]),""!=a?1==jQuery("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:e,field_id:a},"*"):(t.jQuery("#"+a).val(e).trigger("change"),0==r?"function"==typeof t.responsive_filemanager_callback&&t.responsive_filemanager_callback(a):"function"==typeof t[r]&&t[r](a),j()):(i=jQuery("#add_time_to_img").val()?i[0]+"?"+(new Date).getTime():i[0],apply_any(i))},apply_video=function(e,a){var t=h(),r=jQuery("#callback").val();Array.isArray(e)||(e=new Array(e));var i=m(e),e=JSON.stringify(i);1==i.length&&(e=i[0]),""!=a?1==jQuery("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:i[0],field_id:a},"*"):(t.jQuery("#"+a).val(e).trigger("change"),0==r?"function"==typeof t.responsive_filemanager_callback&&t.responsive_filemanager_callback(a):"function"==typeof t[r]&&t[r](a),j()):apply_any(i[0])},apply_none=function(e,a,t){console.log(t),t.parent().find("form a")[1].click(),jQuery(".tip-right").tooltip("hide")},apply_any=function(e){var a;1==jQuery("#crossdomain").val()?window.parent.postMessage({sender:"responsivefilemanager",url:e,field_id:null},"*"):"ckeditor"===jQuery("#editor").val()?(a="CKEditorFuncNum",a=new RegExp("(?:[?&]|&)"+a+"=([^&]+)","i"),a=(a=window.location.search.match(a))&&1<a.length?a[1]:null,window.opener.CKEDITOR.tools.callFunction(a,e),window.close()):(window.parent.postMessage({sender:"responsivefilemanager",url:e,field_id:null},window.location.origin),parent.tinymce.activeEditor.windowManager.close())},apply_file_duplicate=function(e,a){e=e.parent();e.after("<li class='"+e.attr("class")+"' data-name='"+e.attr("data-name")+"'>"+e.html()+"</li>");e=e.next();apply_file_rename(e.find("figure"),a);a=e.find(".download-form"),e="form"+(new Date).getTime();a.attr("id",e),a.find(".tip-right").first().attr("onclick","jQuery('#"+e+"').submit();")},apply_file_rename=function(e,a){e.attr("data-name",a),e.parent().attr("data-name",a),e.find("h4").text(a);var t=e.find("a.link"),r=(n=t.attr("data-file")).substring(n.lastIndexOf("/")+1),i=(i=n.substring(n.lastIndexOf(".")+1))?"."+i:"";t.each(function(){jQuery(this).attr("data-file",encodeURIComponent(a+i))}),e.find("img").each(function(){var e=jQuery(this).attr("src");e?jQuery(this).attr("src",e.replace(r,a+i)+"?time="+(new Date).getTime()):(e=jQuery(this).attr("data-src"),jQuery(this).attr("data-src",e.replace(r,a+i)+"?time="+(new Date).getTime())),jQuery(this).attr("alt",a+" thumbnails")});t=e.find("a.preview");void 0!==(n=t.attr("data-url"))&&n&&t.attr("data-url",n.replace(encodeURIComponent(r),encodeURIComponent(a+i))),e.parent().attr("data-name",a+i),e.attr("data-name",a+i),e.find(".name_download").val(a+i);var n=e.attr("data-path").replace(r,a+i);e.attr("data-path",n)},apply_folder_rename=function(e,a){e.attr("data-name",a),e.find("figure").attr("data-name",a);var t=e.find("h4").find("a").text();e.find("h4 > a").text(a);var r=e.find(".folder-link"),i=r.attr("href"),n=jQuery("#fldr_value").val(),o=i.replace("fldr="+n+encodeURIComponent(t),"fldr="+n+encodeURIComponent(a));r.each(function(){jQuery(this).attr("href",o)});n=e.attr("data-path"),r=n.lastIndexOf("/"),a=n.substr(0,r+1)+a;e.attr("data-path",a)},show_animation=function(){jQuery("#loading_container").css("display","block"),jQuery("#loading").css("opacity",".7")},hide_animation=function(){jQuery("#loading_container").fadeOut()}}(jQuery,Modernizr,image_editor),function(){function e(e,a){a=a||{bubbles:!1,cancelable:!1,detail:void 0};var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,a.bubbles,a.cancelable,a.detail),t}"function"!=typeof window.CustomEvent&&(e.prototype=window.Event.prototype,window.CustomEvent=e)}();